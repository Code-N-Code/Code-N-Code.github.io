<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Company Directory</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
  <div class="max-w-5xl mx-auto py-12 px-6">
    
    <!-- Header -->
    <h1 class="text-4xl font-bold text-gray-800 text-center mb-10">
      Company Directory
    </h1>

    <!-- Search Bar -->
    <div class="flex justify-center mb-8">
      <input type="text" id="searchBox" placeholder="Search companies..."
        class="w-full md:w-1/2 px-4 py-3 rounded-xl border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition"/>
    </div>

    <!-- Dynamic Company List -->
    <div id="companyList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
  </div>

  <script>
    async function loadCompanies() {
      try {
        // Fetch Excel
        const response = await fetch("companies.xlsx");
        const arrayBuffer = await response.arrayBuffer();

        // Parse with SheetJS
        const workbook = XLSX.read(arrayBuffer, { type: "array" });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const data = XLSX.utils.sheet_to_json(sheet);

        const list = document.getElementById("companyList");

        // Generate cards dynamically
        data.forEach(row => {
          const companyName = row["Company Name"];
          const brandName = row["Brand Name"] || companyName;
          const key = companyName.toLowerCase();

          // Save in localStorage
          localStorage.setItem(key, JSON.stringify(row));

          // Create card
          const card = document.createElement("a");
          card.href = `company-details.html?company=${encodeURIComponent(companyName)}`;
          card.className =
            "company-card block p-6 bg-white rounded-2xl shadow hover:shadow-xl transition transform hover:-translate-y-1";
          card.innerHTML = `
            <h2 class="text-xl font-semibold text-indigo-600">${companyName}</h2>
            <p class="text-gray-500">${brandName}</p>
          `;
          list.appendChild(card);
        });


      } catch (err) {
        console.error("Error loading companies.xlsx:", err);
      }
    }

    // Search filter
    document.getElementById("searchBox").addEventListener("keyup", function () {
      const filter = this.value.toLowerCase();
      document.querySelectorAll(".company-card").forEach(card => {
        const text = card.innerText.toLowerCase();
        card.style.display = text.includes(filter) ? "" : "none";
      });
    });

    loadCompanies();
  </script>
</body>
</html>
